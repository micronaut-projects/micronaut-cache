plugins {
    id 'io.micronaut.build.internal.cache-module'
    id 'org.gradle.test-retry'
}

dependencies {
    api projects.cacheCore
    api "com.hazelcast:hazelcast:$hazelcastVersion"

    testAnnotationProcessor 'io.micronaut:micronaut-inject-java'

    testImplementation projects.cacheTck
    testImplementation "com.hazelcast:hazelcast:$hazelcastVersion"
    testImplementation "io.micronaut.test:micronaut-test-spock:$micronautTestVersion"
    testImplementation 'io.micronaut:micronaut-http-client'
    testImplementation 'io.micronaut:micronaut-inject-groovy'
    testImplementation 'io.projectreactor:reactor-core'
    testImplementation 'org.testcontainers:spock:1.16.3'
}

tasks.withType(Test) {
    systemProperty('hazelcastVersion', hazelcastVersion)
    retry {
        maxRetries = 5
        maxFailures = 20
    }
}
