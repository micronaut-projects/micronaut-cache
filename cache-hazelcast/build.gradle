plugins {
    id 'io.micronaut.build.internal.cache-module'
    id 'org.gradle.test-retry'
}

dependencies {
    api project(":cache-core")
    api "com.hazelcast:hazelcast:$hazelcastVersion"

    testAnnotationProcessor "io.micronaut:micronaut-inject-java"

    testImplementation project(":cache-tck")
    testImplementation "com.hazelcast:hazelcast:$hazelcastVersion"
    testImplementation "io.micronaut:micronaut-inject-groovy:$micronautVersion"
    testImplementation "io.micronaut.test:micronaut-test-spock:$micronautTestVersion"
    testImplementation "org.testcontainers:spock:1.16.3"
    testImplementation "io.projectreactor:reactor-core"
    testImplementation "io.micronaut:micronaut-http-client"
}

tasks.withType(Test) {
    systemProperty("hazelcastVersion", hazelcastVersion)
    retry {
        maxRetries = 5
        maxFailures = 20
    }
}
